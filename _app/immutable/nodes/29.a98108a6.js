import{s as ys,h as W,i as os,n as is}from"../chunks/scheduler.dd918b38.js";import{S as Ds,i as ds,r as Es,u as vs,v as us,d as fs,t as ms,w as _s,g as o,s as t,H as z,h as p,j as v,A as u,c as r,F as S,f as d,a as Cs,y as l}from"../chunks/index.94d1baeb.js";import{P as gs,g as As,a as ps}from"../chunks/post_layout.697a27d1.js";function hs(f){let s,n,e,m="Library",a,F,$=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">express</span></div><div class='line'><span style="color: undefined">express-session</span></div><div class='line'><span style="color: undefined">passport</span></div><div class='line'><span style="color: undefined">passport-local</span></div></code></div></pre>`,M,c,_,X="Directory Structure",R,I,Fs=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF"><div class='code-container'><code><div class='line'><span style="color: undefined">app.js</span></div><div class='line'><span style="color: undefined"></span></div><div class='line'><span style="color: undefined">passport</span></div><div class='line'><span style="color: undefined">___index.js</span></div><div class='line'><span style="color: undefined">___localStrategy.js</span></div></code></div></pre>`,U,y,E,C,Y="app.js",B,q,ts=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" js="true"><div class="language-id">js</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> express </span><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">express</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> session </span><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">express-session</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> passport </span><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">passport</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> passportConfig </span><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">./passport/index.js</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">;</span></div><div class='line'></div><div class='line'><span style="color: #C792EA">const</span><span style="color: #EEFFFF"> app </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">express</span><span style="color: #EEFFFF">()</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #82AAFF">passportConfig</span><span style="color: #EEFFFF">()</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #EEFFFF">app</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">use</span><span style="color: #EEFFFF">(</span></div><div class='line'><span style="color: #EEFFFF">  </span><span style="color: #82AAFF">session</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #F07178">secret</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">secret-key</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #F07178">resave</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #FF9CAC">false</span><span style="color: #89DDFF">,</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #F07178">saveUninitialized</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #FF9CAC">false</span><span style="color: #89DDFF">,</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #F07178">cookie</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span><span style="color: #EEFFFF"> </span><span style="color: #F07178">maxAge</span><span style="color: #89DDFF">:</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">1000</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">*</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">60</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">*</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">60</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">*</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">24</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">*</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">7</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #EEFFFF">  </span><span style="color: #89DDFF">&#125;</span><span style="color: #EEFFFF">)</span></div><div class='line'><span style="color: #EEFFFF">)</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #EEFFFF">app</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">use</span><span style="color: #EEFFFF">(passport</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">initialize</span><span style="color: #EEFFFF">())</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #EEFFFF">app</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">use</span><span style="color: #EEFFFF">(passport</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">session</span><span style="color: #EEFFFF">())</span><span style="color: #89DDFF">;</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">app</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">use</span><span style="color: #EEFFFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">/</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> localRouter)</span><span style="color: #89DDFF">;</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">app</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">listen</span><span style="color: #EEFFFF">(</span><span style="color: #F78C6C">3000</span><span style="color: #EEFFFF">)</span><span style="color: #89DDFF">;</span></div></code></div></pre>`,G,i,g,ss="passport/index.js",K,A,ls="session을 생성해 전달하고, 받은 session의 값을 서버에서 사용할 수 있도록 해주는 부분이다.",N,T,rs=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" js="true"><div class="language-id">js</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> passport </span><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">passport</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">prisma</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#125;</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">../prisma/index.js</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> local </span><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">./localStrategy.js</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">;</span></div><div class='line'></div><div class='line'><span style="color: #89DDFF">export</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">default</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">=&gt;</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">  </span><span style="color: #EEFFFF">passport</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">serializeUser</span><span style="color: #F07178">(</span><span style="color: #C792EA">function</span><span style="color: #F07178"> </span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">id</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">done</span><span style="color: #89DDFF">)</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #89DDFF">    </span><span style="color: #546E7A">// done의 두 번째 인자로 session 생성, deserializeUser로 전달</span></div><div class='line'><span style="color: #F07178">    </span><span style="color: #82AAFF">done</span><span style="color: #F07178">(</span><span style="color: #89DDFF">null,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">id</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">  </span><span style="color: #89DDFF">&#125;</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">  </span><span style="color: #EEFFFF">passport</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">deserializeUser</span><span style="color: #F07178">(</span><span style="color: #C792EA">function</span><span style="color: #F07178"> </span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">id</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">done</span><span style="color: #89DDFF">)</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">    </span><span style="color: #82AAFF">done</span><span style="color: #F07178">(</span><span style="color: #89DDFF">null,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">user</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span><span style="color: #F07178"> </span><span style="color: #546E7A">// request로 데이터를 전달 (예시와 같은 경우는 req.user로 전달)</span></div><div class='line'><span style="color: #F07178">  </span><span style="color: #89DDFF">&#125;</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #89DDFF">&#125;;</span></div></code></div></pre>`,O,D,h,as="passport/localStrategy.js",Q,x,ns="password의 전략을 짜는 위치이다.",V,H,cs=`<pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" js="true"><div class="language-id">js</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> passport </span><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">passport</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">Strategy</span><span style="color: #F07178"> </span><span style="color: #89DDFF">as</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">LocalStrategy</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#125;</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">passport-local</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">;</span></div><div class='line'></div><div class='line'><span style="color: #89DDFF">export</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">default</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">=&gt;</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">  </span><span style="color: #EEFFFF">passport</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">use</span><span style="color: #F07178">(</span></div><div class='line'><span style="color: #F07178">    </span><span style="color: #89DDFF">new</span><span style="color: #F07178"> </span><span style="color: #82AAFF">LocalStrategy</span><span style="color: #F07178">(</span></div><div class='line'><span style="color: #F07178">      </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">        usernameField</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">email</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">,</span></div><div class='line'><span style="color: #F07178">        passwordField</span><span style="color: #89DDFF">:</span><span style="color: #F07178"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">password</span><span style="color: #89DDFF">"</span></div><div class='line'><span style="color: #F07178">      </span><span style="color: #89DDFF">&#125;,</span></div><div class='line'><span style="color: #F07178">      </span><span style="color: #C792EA">async</span><span style="color: #F07178"> </span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">email</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">password</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">done</span><span style="color: #89DDFF">)</span><span style="color: #F07178"> </span><span style="color: #C792EA">=&gt;</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">        </span><span style="color: #89DDFF">try</span><span style="color: #F07178"> </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">          </span><span style="color: #82AAFF">done</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">errorMessage</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">dataPayload</span><span style="color: #89DDFF">,</span><span style="color: #F07178"> </span><span style="color: #EEFFFF">callback</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span><span style="color: #F07178"> </span><span style="color: #546E7A">// password Index의 serializeUser로 넘겨줌</span></div><div class='line'><span style="color: #F07178">        </span><span style="color: #89DDFF">&#125;</span><span style="color: #F07178"> </span><span style="color: #89DDFF">catch</span><span style="color: #F07178"> (</span><span style="color: #EEFFFF">error</span><span style="color: #F07178">) </span><span style="color: #89DDFF">&#123;</span></div><div class='line'><span style="color: #F07178">          </span><span style="color: #82AAFF">done</span><span style="color: #F07178">(</span><span style="color: #EEFFFF">error</span><span style="color: #F07178">)</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #F07178">        </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #F07178">      </span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #F07178">    )</span></div><div class='line'><span style="color: #F07178">  )</span><span style="color: #89DDFF">;</span></div><div class='line'><span style="color: #89DDFF">&#125;;</span></div></code></div></pre>`;return{c(){s=o("ul"),n=o("li"),e=o("p"),e.textContent=m,a=t(),F=new z(!1),M=t(),c=o("li"),_=o("p"),_.textContent=X,R=t(),I=new z(!1),U=t(),y=o("ul"),E=o("li"),C=o("p"),C.textContent=Y,B=t(),q=new z(!1),G=t(),i=o("li"),g=o("p"),g.textContent=ss,K=t(),A=o("p"),A.textContent=ls,N=t(),T=new z(!1),O=t(),D=o("li"),h=o("p"),h.textContent=as,Q=t(),x=o("p"),x.textContent=ns,V=t(),H=new z(!1),this.h()},l(b){s=p(b,"UL",{});var j=v(s);n=p(j,"LI",{});var J=v(n);e=p(J,"P",{"data-svelte-h":!0}),u(e)!=="svelte-8jztr3"&&(e.textContent=m),a=r(J),F=S(J,!1),J.forEach(d),M=r(j),c=p(j,"LI",{});var w=v(c);_=p(w,"P",{"data-svelte-h":!0}),u(_)!=="svelte-mbisda"&&(_.textContent=X),R=r(w),I=S(w,!1),U=r(w),y=p(w,"UL",{});var k=v(y);E=p(k,"LI",{});var Z=v(E);C=p(Z,"P",{"data-svelte-h":!0}),u(C)!=="svelte-1eq4lc"&&(C.textContent=Y),B=r(Z),q=S(Z,!1),Z.forEach(d),G=r(k),i=p(k,"LI",{});var L=v(i);g=p(L,"P",{"data-svelte-h":!0}),u(g)!=="svelte-p045ti"&&(g.textContent=ss),K=r(L),A=p(L,"P",{"data-svelte-h":!0}),u(A)!=="svelte-11q7ksz"&&(A.textContent=ls),N=r(L),T=S(L,!1),L.forEach(d),O=r(k),D=p(k,"LI",{});var P=v(D);h=p(P,"P",{"data-svelte-h":!0}),u(h)!=="svelte-sbx49s"&&(h.textContent=as),Q=r(P),x=p(P,"P",{"data-svelte-h":!0}),u(x)!=="svelte-vzhrzs"&&(x.textContent=ns),V=r(P),H=S(P,!1),P.forEach(d),k.forEach(d),w.forEach(d),j.forEach(d),this.h()},h(){F.a=null,I.a=U,q.a=null,T.a=null,H.a=null},m(b,j){Cs(b,s,j),l(s,n),l(n,e),l(n,a),F.m($,n),l(s,M),l(s,c),l(c,_),l(c,R),I.m(Fs,c),l(c,U),l(c,y),l(y,E),l(E,C),l(E,B),q.m(ts,E),l(y,G),l(y,i),l(i,g),l(i,K),l(i,A),l(i,N),T.m(rs,i),l(y,O),l(y,D),l(D,h),l(D,Q),l(D,x),l(D,V),H.m(cs,D)},p:is,d(b){b&&d(s)}}}function xs(f){let s,n;const e=[f[0],es];let m={$$slots:{default:[hs]},$$scope:{ctx:f}};for(let a=0;a<e.length;a+=1)m=W(m,e[a]);return s=new gs({props:m}),{c(){Es(s.$$.fragment)},l(a){vs(s.$$.fragment,a)},m(a,F){us(s,a,F),n=!0},p(a,[F]){const $=F&1?As(e,[F&1&&ps(a[0]),F&0&&ps(es)]):{};F&2&&($.$$scope={dirty:F,ctx:a}),s.$set($)},i(a){n||(fs(s.$$.fragment,a),n=!0)},o(a){ms(s.$$.fragment,a),n=!1},d(a){_s(s,a)}}}const es={title:"Passport-local 구축하기",image:"",alt:"",created:"2024-02-14T00:00:00.000Z",updated:"2024-02-14T00:00:00.000Z",tags:["passport","passport-local"],images:[],slug:"/Javascript/TIL/passport/passport-local/+page.md",path:"/Javascript/TIL/passport/passport-local",toc:!1};function js(f,s,n){return f.$$set=e=>{n(0,s=W(W({},s),os(e)))},s=os(s),[s]}class Ps extends Ds{constructor(s){super(),ds(this,s,js,xs,ys,{})}}export{Ps as component};
